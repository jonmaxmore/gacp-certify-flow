# ระบบการผลิตสมุนไพรไทยตามแนวทางปฏิบัติทางการเกษตรและเก็บเกี่ยวที่ดีของพืชสมุนไพร เพื่อยกระดับมาตรฐานสู่สากล (GACP)# ระบบการผลิตสมุนไพรไทยตามแนวทางปฏิบัติทางการเกษตรและเก็บเกี่ยวที่ดีของพืชสมุนไพร เพื่อยกระดับมาตรฐานสู่สากล (GACP)

## Thai Herbal GACP Certification Platform## GACP Certification Platform - Microservices Architecture



![Version](https://img.shields.io/badge/version-2.0.0-blue.svg)![Version](https://img.shields.io/badge/version-2.0.0-blue.svg)

![License](https://img.shields.io/badge/license-Government-blue.svg)![License](https://img.shields.io/badge/license-Proprietary-red.svg)

![MongoDB](https://img.shields.io/badge/database-MongoDB-green.svg)![MongoDB](https://img.shields.io/badge/database-MongoDB-green.svg)

![Node.js](https://img.shields.io/badge/runtime-Node.js%2018+-brightgreen.svg)![Node.js](https://img.shields.io/badge/runtime-Node.js%2018+-brightgreen.svg)



**โครงการของ: กรมการแพทย์แผนไทยและการแพทย์ทางเลือก**  **Premierprime Co., Ltd. (บริษัท พรีเมียร์ไพร์ม จำกัด)** เป็นบริษัทเทคโนโลยีที่เชี่ยวชาญด้านการพัฒนาระบบดิจิทัลสำหรับภาคเกษตรกรรมและสมุนไพร ด้วยความเชี่ยวชาญในการยกระดับมาตรฐานการผลิตสู่ระดับสากล

**Department of Thai Traditional and Alternative Medicine (DTAM)**

### 🎯 ภารกิจหลัก

แพลตฟอร์มดิจิทัลสำหรับการยกระดับมาตรฐานการผลิตสมุนไพรไทยให้เป็นไปตามแนวทางปฏิบัติทางการเกษตรและเก็บเกี่ยวที่ดี (Good Agricultural and Collection Practices - GACP) เพื่อให้สมุนไพรไทยได้รับการยอมรับในระดับสากล- พัฒนาเทคโนโลยีเพื่อยกระดับมาตรฐานสมุนไพรไทย

- สร้างระบบตรวจสอบและรับรองคุณภาพแบบดิจิทัล

### 🌿 วิสัยทัศน์โครงการ- เชื่อมโยงเกษตรกรกับตลาดสากลผ่านมาตรฐาน GACP

ยกระดับสมุนไพรไทยสู่มาตรฐานสากล ด้วยเทคโนโลยีดิจิทัลที่ทันสมัย เพื่อเสริมสร้างความเชื่อมั่นในคุณภาพและความปลอดภัยของผลิตภัณฑ์สมุนไพรไทยในตลาดโลก- วิจัยและพัฒนานวัตกรรมเกษตรอย่างต่อเนื่อง



---แพลตฟอร์มดิจิทัลสำหรับการยกระดับมาตรฐานการผลิตสมุนไพรไทยให้เป็นไปตามแนวทางปฏิบัติทางการเกษตรและเก็บเกี่ยวที่ดี (Good Agricultural and Collection Practices - GACP) เพื่อให้สมุนไพรไทยได้รับการยอมรับในระดับสากล



## 🏛️ เกี่ยวกับโครงการ### 🌿 วิสัยทัศน์โครงการ

ยกระดับสมุนไพรไทยสู่มาตรฐานสากล ด้วยเทคโนโลยีดิจิทัลที่ทันสมัย เพื่อเสริมสร้างความเชื่อมั่นในคุณภาพและความปลอดภัยของผลิตภัณฑ์สมุนไพรไทยในตลาดโลก
**กรมการแพทย์แผนไทยและการแพทย์ทางเลือก (DTAM)** เป็นหน่วยงานของรัฐที่มีภารกิจในการส่งเสริมและพัฒนาการแพทย์แผนไทยและการแพทย์ทางเลือก รวมถึงการกำกับดูแลคุณภาพสมุนไพรไทยให้ได้มาตรฐานสากล

### 🎯 ภารกิจหลัก
- พัฒนามาตรฐานคุณภาพสมุนไพรไทยให้เป็นที่ยอมรับสากล
- สร้างระบบตรวจสอบและรับรองคุณภาพแบบดิจิทัล
- เชื่อมโยงเกษตรกรกับตลาดสากลผ่านมาตรฐาน GACP
- ส่งเสริมการใช้เทคโนโลยีในการผลิตสมุนไพร

### 📧 ติดต่อเรา
- **Website**: https://www.dtam.go.th
- **Email**: info@dtam.go.th  
- **Phone**: 0-2590-7000
- **Address**: กระทรวงสาธารณสุข ถนนติวานนท์ เขตหนองจันทร์ กรุงเทพฯ 10210

### 🎓 ผู้ทำการวิจัยและพัฒนา
- **มหาวิทยาลัยราชภัฏสวนสุนันทา** - หน่วยงานวิจัยหลัก
- **บริษัท พรีดิกทีฟ เอไอ จำกัด** - พันธมิตรเทคโนโลยี

---

## 🚀 คุณสมบัติหลัก

### 🌿 ระบบจัดการมาตรฐานสมุนไพร
- ✅ การตรวจสอบมาตรฐาน GACP สำหรับพืชสมุนไพรไทย
- ✅ ระบบติดตามการปลูก เก็บเกี่ยว และแปรรูปสมุนไพร
- ✅ การบันทึกข้อมูลแปลงปลูกและพันธุ์สมุนไพร
- ✅ ระบบตรวจสอบคุณภาพตามมาตรฐานสากล

### 👥 ระบบจัดการผู้ใช้
- ✅ ระบบ Role-based Access Control (เกษตรกรสมุนไพร, เจ้าหน้าที่ DTAM, ผู้ดูแลระบบ)
- ✅ การยืนยันตัวตนด้วย JWT Authentication
- ✅ ระบบสิทธิ์การเข้าถึงแบบหลายระดับ
- ✅ โปรไฟล์เกษตรกรพร้อมข้อมูลแปลงสมุนไพร

### 📋 กระบวนการรับรองคุณภาพ
- ✅ ระบบยื่นใบสมัครรับรองมาตรฐาน GACP ออนไลน์
- ✅ การติดตามสถานะการรับรองแบบ Real-time
- ✅ ระบบตรวจสอบเอกสารและกระบวนการผลิต
- ✅ การออกใบรับรองคุณภาพดิจิทัล พร้อม QR Code

### 🔍 ระบบตรวจสอบและประเมิน
- ✅ ฟอร์มตรวจสอบดิจิทัลเฉพาะสมุนไพรไทย
- ✅ การกำหนดตารางเวลาตรวจสอบแปลงอัตโนมัติ
- ✅ ระบบรายงานผลการตรวจสอบคุณภาพ
- ✅ การอัปโหลดรูปภาพประกอบการตรวจสอบ
- ✅ เกณฑ์การประเมินตามมาตรฐาน GACP สำหรับสมุนไพร

### 💳 ระบบชำระเงินและค่าบริการ
- ✅ การชำระค่าตรวจสอบและรับรองออนไลน์
- ✅ ระบบติดตามการชำระเงินแบบ Real-time
- ✅ การออกใบเสร็จและใบกำกับภาษีอัตโนมัติ
- ✅ แพ็กเกจราคาตามประเภทสมุนไพรและขนาดแปลง

---

## 🏗️ สถาปัตยกรรมระบบ

### Technology Stack ที่ใช้งาน

#### Backend Services
- **Runtime**: Node.js 18+ LTS
- **Framework**: Fastify (High Performance)
- **Database**: MongoDB 6.3+ with Mongoose ODM
- **Cache**: Redis 7 for Session & Caching
- **Authentication**: JWT with RS256 Algorithm

#### Infrastructure
- **Containerization**: Docker & Docker Compose
- **API Gateway**: Kong with Security Plugins
- **Load Balancer**: Nginx with SSL Termination
- **Monitoring**: Winston + Elasticsearch (ELK Stack)

#### Security Features
- **Defense-in-Depth**: 5-Layer Security Architecture
- **Rate Limiting**: API Protection
- **Input Validation**: XSS & Injection Prevention
- **Encryption**: Data at Rest & in Transit

### Microservices Architecture

```
┌─────────────────────────────────────────────────────────┐
│                 Frontend Layer                          │
│  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐   │
│  │Farmer Portal │  │  DTAM Portal │  │Public Portal│   │
│  │  (React)     │  │   (React)    │  │ (Next.js)   │   │
│  └──────────────┘  └──────────────┘  └─────────────┘   │
└─────────────────────────────────────────────────────────┘
                           ▼ HTTPS/REST API
┌─────────────────────────────────────────────────────────┐
│                 API Gateway (Kong)                      │
│  • JWT Authentication  • Rate Limiting                 │
│  • CORS Management     • Request Logging               │
│  • Circuit Breaker     • Load Balancing               │
└─────────────────────────────────────────────────────────┘
                           ▼ Internal Services
┌─────────────────────────────────────────────────────────┐
│                   Microservices Layer                   │
│  ┌─────────────────┐  ┌─────────────────┐              │
│  │ Core            │  │ Standards       │              │
│  │ Certification   │  │ Analysis        │              │
│  │ Service         │  │ Service         │              │
│  └─────────────────┘  └─────────────────┘              │
│                                                         │
│  ┌─────────────────┐  ┌─────────────────┐              │
│  │ Survey          │  │ Notification    │              │
│  │ Management      │  │ Service         │              │
│  │ Service         │  │ (Future)        │              │
│  └─────────────────┘  └─────────────────┘              │
└─────────────────────────────────────────────────────────┘
                           ▼ Data Layer
┌─────────────────────────────────────────────────────────┐
│                    Data Persistence                     │
│  ┌─────────────────┐  ┌─────────────────┐              │
│  │ MongoDB Cluster │  │ Redis Cache     │              │
│  │ • Users         │  │ • Sessions      │              │
│  │ • Applications  │  │ • Temp Data     │              │
│  │ • Certificates  │  │ • Rate Limits   │              │
│  └─────────────────┘  └─────────────────┘              │
└─────────────────────────────────────────────────────────┘
```

---

## 📦 โครงสร้างโปรเจ็กต์

```
thai-herbal-gacp-platform/
├── 📁 services/                    # Microservices
│   ├── 📁 core-certification/      # ระบบรับรองหลัก
│   │   ├── 📁 src/
│   │   │   ├── index.js            # Main service entry
│   │   │   └── models/             # MongoDB Schemas
│   │   ├── Dockerfile              # Container config
│   │   └── package.json            # Dependencies
│   ├── 📁 standards-analysis/      # วิเคราะห์มาตรฐาน
│   └── 📁 survey-management/       # จัดการแบบสำรวจ
├── 📁 config/                      # การกำหนดค่า
│   └── api-gateway.config.js       # Kong Gateway setup
├── 📁 security/                    # ระบบรักษาความปลอดภัย
│   └── defense-in-depth.js         # 5-Layer Security
├── 📁 mongo-init/                  # MongoDB Initialization
│   └── 01-init-db.js              # Database setup
├── 📁 nginx/                       # Load Balancer config
├── docker-compose.yml              # Container orchestration
├── package.json                    # Main project config
└── LICENSE                         # DTAM License
```

---

## 🚀 การติดตั้งและใช้งาน

### ความต้องการของระบบ
- **Docker** 20.10+
- **Docker Compose** 2.0+
- **Node.js** 18+ (สำหรับ development)
- **Git** 2.30+

### ขั้นตอนการติดตั้ง

#### 1. Clone Repository
```bash
git clone https://github.com/jonmaxmore/gacp-certify-flow.git
cd gacp-certify-flow
```

#### 2. ตั้งค่า Environment Variables
```bash
# คัดลอกไฟล์ตัวอย่าง
cp .env.example .env

# แก้ไขค่าตัวแปรให้เหมาะสม
nano .env
```

#### 3. เริ่มระบบ
```bash
# สร้างและเริ่ม containers ทั้งหมด
npm run dev

# หรือใช้ docker-compose โดยตรง
docker-compose up -d
```

#### 4. ตรวจสอบการทำงาน
```bash
# ตรวจสอบสถานะ services
docker-compose ps

# ตรวจสอบ health ของ API
curl http://localhost:3001/health

# ดู logs
npm run logs
```

### การเข้าถึงระบบ

| Service | URL | Description |
|---------|-----|-------------|
| **Core API** | http://localhost:3001 | Main certification service |
| **Kong Admin** | http://localhost:8001 | API Gateway management |
| **Nginx** | http://localhost:80 | Load balancer entry point |

### บัญชีผู้ใช้เริ่มต้น

| Role | Email | Password | Description |
|------|-------|----------|-------------|
| **Admin** | admin@dtam.go.th | admin123 | ผู้ดูแลระบบ DTAM |
| **Officer** | officer@dtam.go.th | dtam123 | เจ้าหน้าที่ตรวจสอบ |

---

## 📊 MongoDB Database Schema

### หลัก Collections

#### 👤 Users Collection (ผู้ใช้งาน)
```javascript
{
  _id: ObjectId,
  email: String (unique),
  password: String (hashed),
  role: String, // 'farmer', 'dtam_officer', 'admin'
  fullName: String,
  phoneNumber: String,
  address: {
    address: String,
    subDistrict: String,
    district: String,
    province: String,
    postalCode: String
  },
  farmDetails: {
    farmName: String,
    farmSize: Number,
    farmLocation: { lat: Number, lng: Number },
    herbalTypes: [String] // ประเภทสมุนไพร
  },
  isActive: Boolean,
  createdAt: Date,
  updatedAt: Date
}
```

#### 🌿 Farms Collection (แปลงสมุนไพร)
```javascript
{
  _id: ObjectId,
  farmerId: ObjectId, // ref: Users
  farmName: String,
  farmSize: Number,
  location: {
    address: String,
    coordinates: { lat: Number, lng: Number } // 2dsphere index
  },
  herbalTypes: [String], // ประเภทสมุนไพรที่ปลูก
  farmingMethods: [String], // วิธีการเพาะปลูก
  certificationHistory: [{
    certificateId: ObjectId,
    issueDate: Date,
    expiryDate: Date,
    status: String
  }],
  isActive: Boolean,
  createdAt: Date
}
```

#### 📋 Applications Collection (ใบสมัครรับรอง)
```javascript
{
  _id: ObjectId,
  applicationNumber: String (unique),
  farmerId: ObjectId, // ref: Users
  farmId: ObjectId, // ref: Farms
  applicationType: String, // 'new_certification', 'renewal'
  status: String, // 'draft', 'submitted', 'under_review', 'approved', 'rejected'
  herbalStandardType: String, // ประเภทมาตรฐานสมุนไพร
  submissionDate: Date,
  fees: {
    applicationFee: Number,
    inspectionFee: Number,
    certificateFee: Number,
    totalFee: Number,
    paymentStatus: String // 'pending', 'paid', 'partial'
  },
  documents: [{
    documentType: String,
    fileName: String,
    filePath: String,
    uploadDate: Date,
    verificationStatus: String
  }],
  createdAt: Date
}
```

#### 🏆 Certificates Collection (ใบรับรอง)
```javascript
{
  _id: ObjectId,
  certificateNumber: String (unique),
  applicationId: ObjectId, // ref: Applications
  farmerId: ObjectId, // ref: Users
  herbalStandardType: String,
  issueDate: Date,
  expiryDate: Date,
  status: String, // 'active', 'expired', 'revoked', 'suspended'
  qrCode: String,
  digitalSignature: String,
  issuedBy: String, // DTAM Officer ID
  certificateFile: {
    fileName: String,
    filePath: String
  },
  createdAt: Date
}
```

---

## 🔧 API Endpoints

### Authentication
```
POST /api/v1/auth/login          # เข้าสู่ระบบ
POST /api/v1/auth/logout         # ออกจากระบบ
POST /api/v1/auth/refresh        # Refresh token
```

### Applications Management
```
GET    /api/v1/applications           # ดูรายการใบสมัคร
POST   /api/v1/applications           # สร้างใบสมัครใหม่
GET    /api/v1/applications/:id       # ดูรายละเอียดใบสมัคร
PUT    /api/v1/applications/:id       # แก้ไขใบสมัคร
POST   /api/v1/applications/:id/submit # ส่งใบสมัคร
GET    /api/v1/applications/:id/status # ตรวจสอบสถานะ
```

### Certificates Management
```
GET    /api/v1/certificates           # ดูรายการใบรับรอง
GET    /api/v1/certificates/:id       # ดูรายละเอียดใบรับรอง
POST   /api/v1/certificates/:id/verify # ตรวจสอบความถูกต้อง
GET    /api/v1/certificates/:id/qr    # QR Code สำหรับใบรับรอง
```

### Health Check
```
GET /health                      # ตรวจสอบสถานะระบบ
```

---

## 🔒 ความปลอดภัย

### 5-Layer Defense-in-Depth Architecture

1. **Network Layer**: Nginx SSL Termination + Kong Rate Limiting
2. **Application Layer**: Fastify with Helmet.js Security Headers
3. **Authentication Layer**: JWT with RS256 + Redis Session Management
4. **Data Layer**: MongoDB Encrypted Storage + Input Validation
5. **Monitoring Layer**: Winston Logging + ELK Stack Monitoring

### Security Features
- ✅ JWT Authentication with Refresh Tokens
- ✅ Rate Limiting (100 requests per 15 minutes)
- ✅ Input Validation & Sanitization
- ✅ XSS Protection
- ✅ CSRF Protection
- ✅ NoSQL Injection Prevention
- ✅ Secure HTTP Headers
- ✅ Data Encryption at Rest and in Transit

---

## 📈 การติดตามและ Monitoring

### การดู Logs
```bash
# ดู logs ทั้งหมด
npm run logs

# ดู logs เฉพาะ service
docker-compose logs -f core-certification

# ดู MongoDB logs
docker-compose logs -f mongodb
```

### Health Checks
```bash
# ตรวจสอบ API health
curl http://localhost:3001/health

# ตรวจสอบ Kong status
curl http://localhost:8001/status

# ตรวจสอบ MongoDB connection
docker-compose exec mongodb mongosh -u admin -p --eval "db.runCommand('ping')"
```

---

## 🚀 Production Deployment

### การ Deploy แบบ Production

#### 1. Environment Setup
```bash
# สร้าง production .env
cp .env.example .env.production

# อัปเดตค่าตัวแปรสำหรับ production
nano .env.production
```

#### 2. Build และ Deploy
```bash
# Build production images
npm run build

# Start production services
NODE_ENV=production npm run start
```

#### 3. SSL Certificate Setup
```bash
# วาง SSL certificates ใน nginx/ssl/
mkdir -p nginx/ssl
cp dtam-cert.crt nginx/ssl/
cp dtam-cert.key nginx/ssl/
```

---

## 📞 การสนับสนุนและติดต่อ

### การรายงานปัญหา
หากพบปัญหาหรือต้องการความช่วยเหลือ กรุณาติดต่อ:

- **DTAM Support**: support@dtam.go.th
- **Technical Support**: tech@dtam.go.th
- **Emergency Hotline**: 0-2590-7000

### การขอความช่วยเหลือ
1. ตรวจสอบ Documentation ก่อน
2. ติดต่อ Technical Support ของ DTAM
3. รายงานปัญหาพร้อมรายละเอียดครบถ้วน

---

## 📄 License และ Copyright

**Copyright © 2024-2025 กรมการแพทย์แผนไทยและการแพทย์ทางเลือก**  
**Department of Thai Traditional and Alternative Medicine (DTAM)**

**สิทธิ์ทั้งหมดเป็นของ กรมการแพทย์แผนไทยและการแพทย์ทางเลือก**

This project is owned by the Department of Thai Traditional and Alternative Medicine (DTAM), Ministry of Public Health, Thailand.

### Research Partners
- **มหาวิทยาลัยราชภัฏสวนสุนันทา** - หน่วยงานวิจัยหลัก
- **บริษัท พรีดิกทีฟ เอไอ จำกัด** - พันธมิตรเทคโนโลジี

### Usage Rights
สำหรับการใช้งานเชิงพาณิชย์หรือการขยายผล กรุณาติดต่อ:
- **Email**: licensing@dtam.go.th
- **Phone**: 0-2590-7000

---

## 🙏 Acknowledgments

พัฒนาโดย **ทีมวิจัยและพัฒนา**

**ขอขอบคุณ:**
- กรมการแพทย์แผนไทยและการแพทย์ทางเลือก (DTAM)
- มหาวิทยาลัยราชภัฏสวนสุนันทา  
- บริษัท พรีดิกทีฟ เอไอ จำกัด
- กระทรวงสาธารณสุข

---

<div align="center">

**ระบบการผลิตสมุนไพรไทย GACP**  
**เพื่อยกระดับมาตรฐานสู่สากล**

[![DTAM Website](https://img.shields.io/badge/website-dtam.go.th-blue)](https://www.dtam.go.th)
[![Email](https://img.shields.io/badge/email-info@dtam.go.th-red)](mailto:info@dtam.go.th)

**กรมการแพทย์แผนไทยและการแพทย์ทางเลือก**

</div>